<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Casino Spin Wheel Game</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #040761 0%, #02006d 50%, #0e156b 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            /* max-width: ; */
            margin: 0 auto;
            padding: 24px;
        }

        .game-layout {
            display: grid;
            grid-template-columns: 1fr;
            /* gap: 48px; */
            /* padding-top: 40px; */
        }

        @media (min-width: 768px) {
            .game-layout {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Wheel Sections */
        .wheels-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .wheel-section {
            position: relative;
            border-radius: 16px;
            border: 1px solid rgba(99, 102, 241, 0.4);
            background: rgba(255, 255, 255, 0.05);
            /* backdrop-filter: blur(12px); */
            /* padding: 24px; */
            /* box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3); */
        }

        .wheel-label {
            position: absolute;
            top: -16px;
            left: 45%;
            padding: 4px 16px;
            border-radius: 9999px;
            background: #e0e7ff;
            color: black;
            font-weight: bold;
            font-size: 18px;
            letter-spacing: 0.05em;
        }

        .wheels-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 160px;
            place-items: center;
            position: relative;
        }

        /* Spin Wheel Component */
        .wheel-container {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 8px;
        }

        @media (min-width: 768px) {
            .wheel-container {
                width: 180px;
                height: 180px;
            }
        }

        @media (min-width: 1024px) {
            .wheel-container {
                width: 280px;
                height: 280px;
            }
        }

        .wheel-glow {
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: linear-gradient(135deg, #facc15, #ec4899, #a855f7);
            filter: blur(16px);
            /* opacity: 0.4; */
        }

        .wheel-rim {
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: #fbbf24;
            /* box-shadow: 0 20px 40px rgba(0, 0, 0, 0.9); */
        }

        .wheel-arrow {
            position: absolute;
            top: -16px;
            left: 50%;
            transform: translateX(-50%) rotate(60deg);
            z-index: 50;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 18px solid #FFD700;
            /* filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.9)); */
        }

        @media (max-width: 767px) {
            .wheel-arrow {
                top: -16px;
                border-left: 6px solid transparent;
                border-right: 6px solid transparent;
                border-bottom: 12px solid #FFD700;
            }
        }

        @media (min-width: 1024px) {
            .wheel-arrow {
                top: -4px;
            }
        }

        .wheel-main {
            position: absolute;
            inset: 12px;
            border-radius: 50%;
            transition: transform 7s ease-out;
            /* box-shadow: inset 0 10px 18px rgba(255, 255, 255, 0.25),
                inset 0 -14px 22px rgba(0, 0, 0, 0.9); */
        }

        @media (min-width: 768px) {
            .wheel-main {
                inset: 10px;
            }
        }

        .wheel-number {
            position: absolute;
            inset: 0;
            display: flex;
            justify-content: center;
        }

        .wheel-number span {
            margin-top: 12px;
            font-size: 10px;
            font-weight: 800;
            /* filter: drop-shadow(0 1px 2px rgba(255, 255, 255, 0.6)); */
            transform: rotate(103deg);
        }

        @media (min-width: 768px) {
            .wheel-number span {
                margin-top: 16px;
                font-size: 14px;
            }
        }

        @media (min-width: 1024px) {
            .wheel-number span {
                margin-top: 20px;
                font-size: 24px;
            }
        }

        .wheel-shine {
            position: absolute;
            inset: 0;
            border-radius: 50%;
            /* background: radial-gradient(circle at top, rgba(255, 255, 255, 0.35), transparent 60%); */
            pointer-events: none;
        }

        .wheel-center-button {
            position: absolute;
            inset: 0;
            margin: auto;
            z-index: 50;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #fef3c7, #fbbf24, #d97706);
            border: 1px solid rgba(253, 224, 71, 0.8);
            /* backdrop-filter: blur(12px); */
            transition: all 0.3s;
            cursor: pointer;
        }

        @media (min-width: 768px) {
            .wheel-center-button {
                width: 64px;
                height: 64px;
            }
        }

        /* .wheel-center-button:hover {
            box-shadow: 0 0 20px rgba(234, 179, 8, 0.5);
        } */

        /* .wheel-center-button:active {
            transform: scale(0.95);
        } */

        .wheel-center-shine {
            position: absolute;
            inset: 0;
            border-radius: 50%;
            /* background: linear-gradient(135deg, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.1), transparent); */
            opacity: 0.7;
            pointer-events: none;
        }

        /* Selection Dropdown */
        .selection-container {
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 20;
        }

        .selection-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.6);
            /* backdrop-filter: blur(12px); */
            border: 1px solid rgba(250, 204, 21, 0.5);
            padding: 4px 4px;
            /* box-shadow: 0 10px 25px rgba(0, 0, 0, 0.8); */
        }

        @media (min-width: 640px) {
            .selection-box {
                padding: 8px 12px;
            }
        }

        .selection-glow {
            position: absolute;
            inset: -2px;
            border-radius: 12px;
            background: linear-gradient(90deg, #facc15, #fde047, #facc15);
            /* opacity: 0.3; */
            filter: blur(4px);
        }

        .selection-inputs {
            display: flex;
            gap: 4px;
            z-index: 20;
        }

        .wheel-select {
            width: 20px;
            height: 24px;
            text-align: center;
            font-size: 12px;
            font-weight: 800;
            color: #fde047;
            background: linear-gradient(180deg, #000, #18181b);
            border-radius: 6px;
            border: 1px solid rgba(234, 179, 8, 0.7);
            /* box-shadow: inset 0 0 8px rgba(255, 215, 0, 0.3); */
            cursor: pointer;
        }

        @media (min-width: 640px) {
            .wheel-select {
                width: 24px;
                height: 36px;
                font-size: 14px;
            }
        }

        @media (min-width: 768px) {
            .wheel-select {
                width: 44px;
                height: 56px;
                font-size: 20px;
            }
        }

        .wheel-select:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .wheel-select option {
            background: rgb(199, 170, 5);
            color: #000000;
        }

        /* Info Panel */
        .info-panel {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            gap: 32px;
        }

        .game-timing {
            width: 100%;
            max-width: 448px;
            border-radius: 16px;
            border: 1px solid rgba(251, 113, 133, 0.4);
            background: rgba(255, 255, 255, 0.05);
            /* backdrop-filter: blur(12px); */
            padding: 16px 24px;
            /* box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6); */
        }

        .game-timing-label {
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 0.25em;
            color: #fb7185;
            margin-bottom: 8px;
        }

        .timing-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .time-badge {
            padding: 4px 16px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.4);
            color: #fde047;
            font-weight: bold;
            font-size: 14px;
        }

        .time-separator {
            color: #d1d5db;
            font-size: 12px;
            font-weight: 500;
        }

        /* Timer Box */
        .timer-box {
            width: 100%;
            max-width: 448px;
            border-radius: 16px;
            border: 1px solid rgba(250, 204, 21, 0.7);
            background: rgba(0, 0, 0, 0.4);
            padding: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .timer-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            letter-spacing: 0.025em;
        }

        .timer-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .timer-item {
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(67, 56, 202, 0.5), rgba(49, 46, 129, 0.5));
            padding: 16px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        }

        .timer-value {
            font-size: 36px;
            font-weight: bold;
            color: #fde047;
        }

        .timer-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #d1d5db;
            margin-top: 4px;
        }

        /* Waiting State */
        .waiting-container {
            display: grid;
            place-items: center;
        }

        .waiting-box {
            position: relative;
            width: 100%;
            max-width: 384px;
            overflow: hidden;
            border-radius: 16px;
            background: linear-gradient(135deg, rgba(67, 56, 202, 0.4), rgba(55, 48, 163, 0.4), rgba(49, 46, 129, 0.5));
            padding: 24px;
            /* box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(12px); */
            border: 1px solid rgba(129, 140, 248, 0.3);
        }

        .waiting-pulse {
            position: absolute;
            inset: 0;
            z-index: -1;
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            background: rgba(99, 102, 241, 0.1);
            filter: blur(32px);
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .waiting-spinner-container {
            display: flex;
            justify-content: center;
            margin-bottom: 16px;
        }

        .waiting-spinner {
            height: 56px;
            width: 56px;
            border-radius: 50%;
            border: 4px solid rgba(165, 180, 252, 0.3);
            border-top-color: #a5b4fc;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .waiting-title {
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            color: #e0e7ff;
            letter-spacing: 0.025em;
        }

        .waiting-dots {
            margin-top: 4px;
            display: flex;
            justify-content: center;
            gap: 4px;
            color: #a5b4fc;
            font-size: 20px;
        }

        .waiting-dots span {
            animation: bounce 1s infinite;
        }

        .waiting-dots span:nth-child(2) {
            animation-delay: 150ms;
        }

        .waiting-dots span:nth-child(3) {
            animation-delay: 300ms;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-8px);
            }
        }

        .waiting-subtitle {
            margin-top: 12px;
            text-align: center;
            font-size: 14px;
            color: rgba(165, 180, 252, 0.8);
        }

        /* Results Display */
        .results-container {
            position: relative;
            width: 100%;
            max-width: 448px;
            cursor: pointer;
        }



        .results-container:hover .results-glow {
            opacity: 0.9;
            filter: blur(12px);
        }

        .results-box {
            position: relative;
            border-radius: 16px;
            border: 1px solid rgba(250, 204, 21, 0.6);
            background: rgba(0, 0, 0, 0.6);
            padding: 24px;
            /* box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); */
            backdrop-filter: blur(12px);

        }

        .results-box:hover {
            border: 1px solid rgb(248, 0, 62);
            /* box-shadow: 0px 4px 6px 2px rgb(248, 248, 248); */
        }

        .results-title {
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            letter-spacing: 0.05em;
            color: #fde047;

        }

        .results-container:hover .results-title {
            color: #facc15;
        }

        .results-subtitle {
            margin-top: 8px;
            text-align: center;
            font-size: 16px;
            color: #9ca3af;

        }

        .results-container:hover .results-subtitle {
            color: #d1d5db;
        }

        .results-content {
            margin-top: 24px;
        }

        .results-waiting {
            text-align: center;
            padding: 32px 0;
        }

        .results-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .results-waiting-text {
            color: #6b7280;
            font-size: 14px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .result-item {
            border-radius: 12px;
            border: 1px solid rgba(250, 204, 21, 0.3);
            background: rgba(0, 0, 0, 0.4);
            padding: 16px;
            /* backdrop-filter: blur(4px); */
            text-align: center;
        }

        .result-label {
            font-size: 56px;
            font-weight: 600;
            color: #f3f4f6;
            margin-bottom: 8px;
        }

        .result-value {
            font-size: 36px;
            font-weight: bold;
            color: #fde047;
        }

        /* Game Closed Overlay */
        .game-closed {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .game-closed-content {
            text-align: center;
            max-width: 600px;
        }

        .game-closed-icon {
            font-size: 96px;
            margin-bottom: 16px;
        }

        .game-closed-title {
            font-size: 36px;
            font-weight: bold;
            color: #fde047;
            margin-bottom: 16px;
        }

        .game-closed-description {
            font-size: 20px;
            color: #d1d5db;
            margin-bottom: 32px;
        }

        .countdown-box {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 16px;
            padding: 24px;
            backdrop-filter: blur(12px);
            border: 1px solid rgba(250, 204, 21, 0.3);
            margin-bottom: 32px;
        }

        .countdown-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .countdown-grid {
            display: flex;
            justify-content: center;
            gap: 32px;
        }

        .countdown-item {
            background: rgba(67, 56, 202, 0.5);
            border-radius: 12px;
            padding: 16px 24px;
        }

        .countdown-value {
            font-size: 32px;
            font-weight: bold;
            color: #fde047;
        }

        .countdown-label {
            font-size: 14px;
            color: #d1d5db;
            margin-top: 4px;
        }

        .game-closed-footer {
            font-size: 14px;
            color: #9ca3af;
        }
    </style>
</head>

<body>
    <div id="app"></div>

    <script>
        const prizes = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9"];
        const colors = [
            "#EC2721", "#008200", "#EC2721", "#008200", "#EC2721",
            "#008200", "#EC2721", "#ff4c4c", "#444C38", "#16a34a"
        ];

        let state = {
            spinning: false,
            isWaiting: false,
            gameClosed: false,
            isGameActive: false,
            currentRound: 1,
            roundTimeLeft: 0,
            timeUntilNextGame: 0,
            nextGameStart: null,
            token: null,
            socket: null,
            results: { a1: null, a2: null, b1: null, b2: null, c1: null, c2: null },
            serverWheelValues: { a1: null, a2: null, b1: null, b2: null, c1: null, c2: null },
            userSelections: { a1: undefined, a2: undefined, b1: undefined, b2: undefined, c1: undefined, c2: undefined }
        };

        const wheelRotations = { a1: 0, a2: 0, b1: 0, b2: 0, c1: 0, c2: 0 };

        function init() {
            state.token = sessionStorage.getItem("token");
            initializeSocket();
            initialRender();
            startTimerUpdate();
        }

        function initializeSocket() {
            const socket = io('https://gamebackend-l3pd.onrender.com', { path: '/api/socket' });
            state.socket = socket;

            socket.on('connect', () => console.log('Connected to game server'));

            socket.on('game-state', (data) => {
                state.isGameActive = data.isActive;
                state.gameClosed = !data.isActive;
                state.currentRound = data.currentRound || 1;
                state.roundTimeLeft = data.roundTimeLeft || 0;
                state.timeUntilNextGame = data.timeUntilEnd || 0;
                state.nextGameStart = data.nextGameStart || null;
                if (data.currentResults) state.results = data.currentResults;
                fullRender();
            });

            socket.on('game-timer', (data) => {
                state.roundTimeLeft = data.roundTimeLeft;
                state.currentRound = data.roundNumber;
                state.isGameActive = data.isActive;
                updateTimerOnly();
            });

            socket.on('round-start', (data) => {
                state.currentRound = data.roundNumber;
                state.roundTimeLeft = data.roundTimeLeft;
                state.spinning = true;
                state.isWaiting = true;
                state.serverWheelValues = data.wheelValues;
                state.results = { a1: null, a2: null, b1: null, b2: null, c1: null, c2: null };

                const wheelKeys = ['a1', 'a2', 'b1', 'b2', 'c1', 'c2'];
                wheelKeys.forEach(key => {
                    spinWheel(key, state.serverWheelValues[key]);
                });

                updateSelectorsState();
            });

            socket.on('wheel-values-update', (data) => {
                state.serverWheelValues = data.wheelValues;
            });

            socket.on('game-closed', (data) => {
                state.gameClosed = true;
                state.isGameActive = false;
                state.timeUntilNextGame = data.timeUntilNextGame;
                state.nextGameStart = data.nextGameStart;
                fullRender();
            });
        }

        function spinWheel(wheelKey, value) {
            console.log('Spinning wheel:', wheelKey, 'Value:', value);
            const hasInput = typeof value === "number" && value >= 0 && value < prizes.length;
            const selectedIndex = hasInput ? value : Math.floor(Math.random() * prizes.length);

            const sliceAngle = 360 / prizes.length;
            const randomRounds = Math.floor(Math.random() * 6) + 10;
            const fullRotation = randomRounds * 360;
            const sliceCenter = selectedIndex * sliceAngle + sliceAngle / 2;

            const currentAngle = wheelRotations[wheelKey] % 360;
            const targetAngle = 360 - sliceCenter - 110;
            wheelRotations[wheelKey] += fullRotation + (targetAngle - currentAngle);

            const wheelElement = document.querySelector(`[data-wheel="${wheelKey}"] .wheel-main`);
            if (wheelElement) {
                wheelElement.style.transform = `rotate(${wheelRotations[wheelKey]}deg)`;
            }

            setTimeout(() => {
                state.results[wheelKey] = selectedIndex;
                console.log(`ðŸŽ¯ ${wheelKey} Result:`, selectedIndex);

                const allWheelsFinished = Object.values(state.results).every(result => result !== null);
                if (allWheelsFinished) {
                    state.spinning = false;
                    state.isWaiting = false;
                    updateResultsDisplay();
                    updateSelectorsState();
                }
            }, 7000);
        }

        function createWheelBackground() {
            const sliceAngle = 360 / prizes.length;
            let gradient = "conic-gradient(";
            prizes.forEach((_, i) => {
                const start = i * sliceAngle;
                const end = start + sliceAngle;
                gradient += `${colors[i]} ${start}deg ${end}deg,`;
            });
            return gradient.slice(0, -1) + ")";
        }

        function createWheel(wheelKey) {
            const sliceAngle = 360 / prizes.length;
            const background = createWheelBackground();

            return `
                <div class="wheel-container" data-wheel="${wheelKey}">
                    <div class="wheel-glow"></div>
                    <div class="wheel-rim"></div>
                    <div class="wheel-arrow"></div>
                    <div class="wheel-main" style="background: ${background}; transform: rotate(${wheelRotations[wheelKey]}deg);">
                        ${prizes.map((p, i) => `
                            <div class="wheel-number" style="transform: rotate(${i * sliceAngle + sliceAngle / 2}deg);">
                                <span>${p}</span>
                            </div>
                        `).join('')}
                        <div class="wheel-shine"></div>
                    </div>
                    <button class="wheel-center-button">
                        <span class="wheel-center-shine"></span>
                    </button>
                </div>
            `;
        }

        function createWheelSection(label, wheel1Key, wheel2Key) {
            const showSelections = state.token !== null;

            return `
                <div class="wheel-section">
                    <span class="wheel-label">${label}</span>
                    <div class="wheels-grid">
                        ${createWheel(wheel1Key)}
                        ${createWheel(wheel2Key)}
                        ${showSelections ? `
                            <div class="selection-container">
                                <div class="selection-box">
                                    <div class="selection-glow"></div>
                                    <div class="selection-inputs">
                                        <select class="wheel-select" data-select="${wheel1Key}" ${state.spinning ? 'disabled' : ''}>
                                            <option value="">X</option>
                                            ${prizes.map(d => `<option value="${d}" ${state.userSelections[wheel1Key] === parseInt(d) ? 'selected' : ''}>${d}</option>`).join('')}
                                        </select>
                                        <select class="wheel-select" data-select="${wheel2Key}" ${state.spinning ? 'disabled' : ''}>
                                            <option value="">X</option>
                                            ${prizes.map(d => `<option value="${d}" ${state.userSelections[wheel2Key] === parseInt(d) ? 'selected' : ''}>${d}</option>`).join('')}
                                        </select>
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function getMinutesAndSeconds(timeLeft) {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            return { minutes, seconds };
        }

        function initialRender() {
            fullRender();
        }

        function fullRender() {
            const app = document.getElementById('app');

            if (state.gameClosed) {
                renderGameClosed(app);
                return;
            }

            renderGameActive(app);
            attachEventListeners();
        }

        function renderGameClosed(app) {
            const nextGameTime = state.nextGameStart instanceof Date && !isNaN(state.nextGameStart.getTime())
                ? state.nextGameStart.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true })
                : '9:00 AM';

            const hours = Math.floor(state.timeUntilNextGame / 3600);
            const minutes = Math.floor((state.timeUntilNextGame % 3600) / 60);
            const seconds = state.timeUntilNextGame % 60;

            app.innerHTML = `
                <div class="game-closed">
                    <div class="game-closed-content">
                        <div class="game-closed-icon">ðŸŒ™</div>
                        <h1 class="game-closed-title">Game Closed</h1>
                        <p class="game-closed-description">The game is currently closed. Next game starts tomorrow at ${nextGameTime}.</p>
                        
                        <div class="countdown-box">
                            <p class="countdown-title">Next Game Countdown</p>
                            <div class="countdown-grid">
                                <div class="countdown-item">
                                    <p class="countdown-value" id="closed-hours">${hours}</p>
                                    <p class="countdown-label">Hours</p>
                                </div>
                                <div class="countdown-item">
                                    <p class="countdown-value" id="closed-minutes">${minutes}</p>
                                    <p class="countdown-label">Minutes</p>
                                </div>
                                <div class="countdown-item">
                                    <p class="countdown-value" id="closed-seconds">${seconds}</p>
                                    <p class="countdown-label">Seconds</p>
                                </div>
                            </div>
                        </div>
                        
                        <p class="game-closed-footer">Please check back tomorrow for the next game session.</p>
                    </div>
                </div>
            `;
        }

        function renderGameActive(app) {
            const { minutes, seconds } = getMinutesAndSeconds(state.isGameActive ? state.roundTimeLeft : state.timeUntilNextGame);

            app.innerHTML = `
                <div class="container">
                    <div class="game-layout">
                        <div class="wheels-container">
                            ${createWheelSection('A', 'a1', 'a2')}
                            ${createWheelSection('B', 'b1', 'b2')}
                            ${createWheelSection('C', 'c1', 'c2')}
                        </div>
                        
                        <div class="info-panel">
                            <div class="game-timing">
                                <p class="game-timing-label">GAME RESULT TIMING</p>
                                <div class="timing-display">
                                    <span class="time-badge">09:00 AM</span>
                                    <span class="time-separator">TO</span>
                                    <span class="time-badge">09:00 PM</span>
                                </div>
                            </div>
                            
                            <div class="timer-box">
                                <p class="timer-title">Results On Time</p>
                                <div class="timer-grid">
                                    <div class="timer-item">
                                        <p class="timer-value" id="timer-minutes">${minutes}</p>
                                        <p class="timer-label">Minute</p>
                                    </div>
                                    <div class="timer-item">
                                        <p class="timer-value" id="timer-seconds">${seconds}</p>
                                        <p class="timer-label">Second</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="results-container" onclick="window.location.href='/history'">
                                <div class="results-box">
                                    <p class="results-title">Result</p>
                                    <p class="results-subtitle">Old Result Click here</p>
                                    
                                    <div class="results-content">
                                        <div class="results-grid" id="results-grid">
                                            ${['A', 'B', 'C'].map(label => {
                const key1 = `${label.toLowerCase()}1`;
                const key2 = `${label.toLowerCase()}2`;
                const val1 = state.results[key1] !== null ? state.results[key1] : 'â€”';
                const val2 = state.results[key2] !== null ? state.results[key2] : 'â€”';
                return `
                                                    <div class="result-item">
                                                        <div class="result-label">${label}</div>
                                                        <div class="result-value">${val1}${val2}</div>
                                                    </div>
                                                `;
            }).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Update only timer values without re-rendering entire DOM
        function updateTimerOnly() {
            const minutesEl = document.getElementById('timer-minutes');
            const secondsEl = document.getElementById('timer-seconds');

            if (minutesEl && secondsEl) {
                const { minutes, seconds } = getMinutesAndSeconds(state.isGameActive ? state.roundTimeLeft : state.timeUntilNextGame);
                minutesEl.textContent = minutes;
                secondsEl.textContent = seconds;
            }

            // Update closed game countdown if visible
            const closedHours = document.getElementById('closed-hours');
            const closedMinutes = document.getElementById('closed-minutes');
            const closedSeconds = document.getElementById('closed-seconds');

            if (closedHours && closedMinutes && closedSeconds) {
                const hours = Math.floor(state.timeUntilNextGame / 3600);
                const minutes = Math.floor((state.timeUntilNextGame % 3600) / 60);
                const seconds = state.timeUntilNextGame % 60;

                closedHours.textContent = hours;
                closedMinutes.textContent = minutes;
                closedSeconds.textContent = seconds;
            }
        }

        // Update only results display without re-rendering wheels
        function updateResultsDisplay() {
            const resultsGrid = document.getElementById('results-grid');

            if (resultsGrid) {
                resultsGrid.innerHTML = ['A', 'B', 'C'].map(label => {
                    const key1 = `${label.toLowerCase()}1`;
                    const key2 = `${label.toLowerCase()}2`;
                    const val1 = state.results[key1] !== null ? state.results[key1] : 'â€”';
                    const val2 = state.results[key2] !== null ? state.results[key2] : 'â€”';
                    return `
                        <div class="result-item">
                            <div class="result-label">${label}</div>
                            <div class="result-value">${val1}${val2}</div>
                        </div>
                    `;
                }).join('');
            }
        }

        // Update selector disabled state without full re-render
        function updateSelectorsState() {
            document.querySelectorAll('.wheel-select').forEach(select => {
                if (state.spinning) {
                    select.disabled = true;
                } else {
                    select.disabled = false;
                }
            });
        }

        // Start timer update interval
        function startTimerUpdate() {
            setInterval(() => {
                if (state.isGameActive && state.roundTimeLeft > 0) {
                    state.roundTimeLeft--;
                    updateTimerOnly();
                } else if (state.gameClosed && state.timeUntilNextGame > 0) {
                    state.timeUntilNextGame--;
                    updateTimerOnly();
                }
            }, 1000);
        }

        // Attach event listeners for user interactions
        function attachEventListeners() {
            document.querySelectorAll('[data-select]').forEach(select => {
                select.addEventListener('change', (e) => {
                    const wheelKey = e.target.getAttribute('data-select');
                    const value = e.target.value === '' ? undefined : parseInt(e.target.value);
                    state.userSelections[wheelKey] = value;

                    if (state.socket) {
                        state.socket.emit('user-selection', {
                            ...state.userSelections,
                            timestamp: Date.now()
                        });
                    }
                });
            });
        }

        // Start app
        init();
    </script>
</body>

</html>